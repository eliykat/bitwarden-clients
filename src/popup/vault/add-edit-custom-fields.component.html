<div class="box">
    <div class="box-header">
        {{'customFields' | i18n}}
    </div>
    <div class="box-content" [formGroup]="form">
        <!-- Current custom fields -->
        <div cdkDropList (cdkDropListDropped)="drop($event)" *ngIf="cipher.hasFields" formArrayName="fields">
            <div class="box-content-row box-content-row-multi box-draggable-row" appBoxRow cdkDrag
                *ngFor="let f of fields?.controls; let i = index; trackBy:trackByFunction">
                <!-- [ngClass]="{'box-content-row-checkbox': f.type === fieldType.Boolean}"> -->
                <ng-container [formGroupName]="i">
                    <a href="#" appStopClick (click)="removeField(i)" appA11yTitle="{{'remove' | i18n}}">
                        <i class="fa fa-minus-circle fa-lg" aria-hidden="true"></i>
                    </a>
                    <label for="fieldName{{i}}" class="sr-only">{{'name' | i18n}}</label>
                    <label for="fieldValue{{i}}" class="sr-only">{{'value' | i18n}}</label>
                    <div class="row-main">
                        <input id="fieldName{{i}}" type="text" name="Field.Name{{i}}" formControlName="name"
                            class="row-label" placeholder="{{'name' | i18n}}" appInputVerbatim>
                        <!--Custom Field: Text-->
                        <input id="fieldValue{{i}}" type="text" name="Field.Value{{i}}" formControlName="value"
                            *ngIf="f.get('type').value === fieldType.Text" placeholder="{{'value' | i18n}}" appInputVerbatim>
                        <!--Custom Field: Hidden-->
                        <input id="fieldValue{{i}}" type="{{f.get('showValue').value ? 'text' : 'password'}}" name="Field.Value{{i}}"
                            formControlName="value" class="monospaced" appInputVerbatim *ngIf="f.get('type').value === fieldType.Hidden"
                            placeholder="{{'value' | i18n}}" [disabled]="!cipher.viewPassword && !f.get('newField').value">
                    </div>
                    <!--Custom Field: Boolean-->
                    <input id="fieldValue{{i}}" name="Field.Value{{i}}" type="checkbox" formControlName="value"
                        *ngIf="f.get('type').value === fieldType.Boolean" appTrueFalseValue trueValue="true" falseValue="false">
                    <div class="action-buttons" *ngIf="f.get('type').value === fieldType.Hidden && (cipher.viewPassword || f.get('newField').value)">
                        <a class="row-btn" href="#" appStopClick appBlurClick appA11yTitle="{{'toggleVisibility' | i18n}}"
                            (click)="toggleShowValue(f.get('showValue'))">
                            <i class="fa fa-lg" aria-hidden="true"
                                [ngClass]="f.get('showValue').value ? 'fa-eye-slash' : 'fa-eye'"></i>
                        </a>
                    </div>
                    <div class="drag-handle" appA11yTitle="{{'dragToSort' | i18n}}" cdkDragHandle>
                        <i class="fa fa-bars" aria-hidden="true"></i>
                    </div>
                </ng-container>
            </div>
        </div>
        <!-- Add new custom field -->
        <div class="box-content-row box-content-row-newmulti" appBoxRow>
            <a href="#" appStopClick (click)="addField()">
                <i class="fa fa-plus-circle fa-fw fa-lg" aria-hidden="true"></i> {{'newCustomField' | i18n}}
            </a>
            <label for="addFieldType" class="sr-only">{{'type' | i18n}}</label>
            <select id="addFieldType" name="AddFieldType" formControlName="addFieldType" class="field-type">
                <option *ngFor="let o of addFieldTypeOptions" [ngValue]="o.value">{{o.name}}</option>
            </select>
        </div>
    </div>
</div>
